async function beginScan(n){async function t(){r=!1;i.removeListener("scan",u);window.removeEventListener("pushstate",t);window.removeEventListener("popstate",t);await i.stop()}async function u(i){console.log(i);await n.invokeMethodAsync("Validate",i);await t()}let r=!0;let i=new Instascan.Scanner({video:document.getElementById("preview"),mirror:!1});window.addEventListener("popstate",t);try{let t=await Instascan.Camera.getCameras();t.length>0?(i.addListener("scan",await u),await i.start(t[0]),await n.invokeMethodAsync("NotifyScanStarted")):(await n.invokeMethodAsync("NotifyCameraNotFound"),console.error("No cameras found."))}catch(f){await n.invokeMethodAsync("NotifyCameraError");console.error(f)}finally{r===!1&&await t()}}(function(n){var t=n.pushState;n.pushState=function(i){if(typeof n.onpushstate=="function")n.onpushstate({state:i});return window.dispatchEvent(new Event("popstate")),t.apply(n,arguments)}})(window.history);